#!/usr/bin/env bash

chrome_extension_id="$1"
output_filepath="$2"

if [ -z "$output_filepath" ]; then
  output_filepath=$(pwd)"/${chrome_extension_id}.crx"
fi

crx_download_url="https://clients2.google.com/service/update2/crx?response=redirect&prodversion=61.0&x=id%3D${chrome_extension_id}%26installsource%3Dondemand%26uc"

wget --no-check-certificate --no-iri \
  --referer="https://chrome.google.com/webstore/detail/${chrome_extension_id}?hl=en" \
  --user-agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/61.0.3163.100 Safari/537.36" \
  -O "$output_filepath" "$crx_download_url"
